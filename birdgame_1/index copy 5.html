<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Physics tori</title>
  <!-- Pico.css CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <!-- Matter.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

</head>

<body class="container">

  <header>
    <hgroup>
      <h1>tobutori</h1>
    </hgroup>
  </header>

  <main>
    <div id="game-container"></div>
    <button class="secondary" onclick="location.reload()">リセット</button>
  </main>

  <script src="https://cdn.jsdelivr.net/gh/takahiro-inoway/workshop@main/birdgame_1/workshop_1.js"></script>

  <script>
    // 背景を描画する
    // 全体のサイズを指定
    const width = 1200;
    const height = 1400;
    // ライブラリでレンダリングの準備
    const render = Render.create({
      element: document.getElementById('game-container'),
      engine: engine,
      options: { width, height, wireframes: false, background: '#f4f4f4' }
    });

    // ハコを描画する
    // 1. デザインを考える
    const size = 40;    // 箱のサイズ
    const men_color = '#fb8c00';
    const sen_color = '#ef6c00';
    const futosa = 1;
    // 2. ハコの配置を考える（0が空白、1が箱）
    // 配列の上が実際の画面の上部、配列の下が画面の下部になります
    const layout = [
      [0, 0, 1, 0, 0], // 1段目（上）
      [0, 0, 1, 0, 0], // 2段目
      [0, 1, 1, 0, 0], // 3段目
      [0, 1, 1, 1, 0], // 4段目
      [1, 1, 1, 1, 1]  // 5段目（下）
    ];
    // 3.配置する位置を決める
    const startX = 900; // 左端の基準座標
    const startY = 600; // 上端の基準座標
    // 4. レイアウト配列をループで回す
    const hako = [];
    layout.forEach((row, r) => {
      row.forEach((cell, c) => {
        // 値が 1 の場合のみオブジェクトを作成
        if (cell !== 1) return
        // ハコの配列に追加します
        hako.push(Bodies.rectangle(
          startX + c * size, startY + r * 45, size, size,
          { render: { fillStyle: men_color, strokeStyle: sen_color, lineWidth: futosa } }
        ));
      });
    });

    // 地面を描画する
    const j_x = 600;
    const j_y = 1200;
    const j_haba = 1200;
    const j_takasa = 400;
    const j_color = '#333';
    // rectangle(x, y, width, height, [options]): 中心座標、幅、高さ、オプション
    const jimen = Bodies.rectangle(
      j_x, j_y, j_haba, j_takasa,
      { isStatic: true, render: { fillStyle: j_color } }
    );

    // 世界(world)に全ての物体(地面、鳥、バネ、マウス制約、箱の束)を追加
    Composite.add(world, [jimen, ...hako]);

  </script>

  <script src="https://cdn.jsdelivr.net/gh/takahiro-inoway/workshop@main/birdgame_1/workshop_2.js"></script>

</body>

</html>